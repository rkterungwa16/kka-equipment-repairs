<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tailoring Shop Maintenance Tracker</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #f9f9f9;
      }
      h2 {
        color: #333;
      }
      form,
      table {
        background: #fff;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }
      input,
      select,
      textarea,
      button,
      datalist {
        margin: 5px 0;
        padding: 8px;
        width: 100%;
        border: 1px solid #ccc;
        border-radius: 5px;
      }
      button {
        background: #007bff;
        color: white;
        border: none;
        cursor: pointer;
        margin-right: 10px;
      }
      button:hover {
        background: #0056b3;
      }
      table {
        width: 100%;
        border-collapse: collapse;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
      }
      th {
        background: #007bff;
        color: white;
      }
    </style>
  </head>
  <body>
    <h2>Tailoring Shop Equipment Maintenance Tracker</h2>

    <form id="maintenanceForm">
      <label>Equipment:</label>
      <select id="equipment" required>
        <option value="">-- Select Equipment --</option>
        <option value="Sewing Machine">Sewing Machine</option>
        <option value="Overlock Machine">Overlock Machine</option>
        <option value="Steam Iron">Steam Iron</option>
        <option value="Cutting Table">Cutting Table</option>
        <option value="Fabric Scissors">Fabric Scissors</option>
        <option value="Dress Form">Dress Form</option>
      </select>

      <label>Serial/ID:</label>
      <input list="serials" id="serial" required />
      <datalist id="serials">
        <option value="SM-001"></option>
        <option value="OL-001"></option>
        <option value="IR-001"></option>
        <option value="CT-001"></option>
        <option value="SC-001"></option>
        <option value="DF-001"></option>
      </datalist>

      <label>Last Maintenance Date:</label>
      <input type="date" id="lastDate" required />

      <label>Issue Reported:</label>
      <input type="text" id="issue" />

      <label>Repair/Maintenance Done:</label>
      <input type="text" id="repair" />

      <label>Next Due Date:</label>
      <input type="date" id="nextDate" />

      <label>Technician/Handled By:</label>
      <input type="text" id="technician" />

      <label>Notes:</label>
      <textarea id="notes"></textarea>

      <button type="submit">Add Record</button>
    </form>

    <button id="downloadJson">Download JSON</button>
    <button id="downloadCsv">Download CSV</button>

    <table>
      <thead>
        <tr>
          <th>Equipment</th>
          <th>Serial/ID</th>
          <th>Last Maintenance Date</th>
          <th>Issue Reported</th>
          <th>Repair/Maintenance Done</th>
          <th>Next Due Date</th>
          <th>Technician</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody id="recordsTable">
        <!-- Records will appear here -->
      </tbody>
    </table>

    <script>
      const form = document.getElementById("maintenanceForm");
      const tableBody = document.getElementById("recordsTable");
      const downloadBtn = document.getElementById("downloadJson");
      const downloadCsvBtn = document.getElementById("downloadCsv");

      // Store records in an array
      let records =
        JSON.parse(localStorage.getItem("maintenanceRecords")) || [];

      // Function to render table
      function renderTable() {
        tableBody.innerHTML = "";
        records.forEach((record) => {
          const row = document.createElement("tr");
          row.innerHTML = `
        <td>${record.equipment}</td>
        <td>${record.serial}</td>
        <td>${record.lastMaintenanceDate}</td>
        <td>${record.issueReported}</td>
        <td>${record.repairDone}</td>
        <td>${record.nextDueDate}</td>
        <td>${record.technician}</td>
        <td>${record.notes}</td>
      `;
          tableBody.appendChild(row);
        });
      }

      // Initial render
      renderTable();

      // Handle form submit
      form.addEventListener("submit", function (e) {
        e.preventDefault();

        const record = {
          equipment: document.getElementById("equipment").value,
          serial: document.getElementById("serial").value,
          lastMaintenanceDate: document.getElementById("lastDate").value,
          issueReported: document.getElementById("issue").value,
          repairDone: document.getElementById("repair").value,
          nextDueDate: document.getElementById("nextDate").value,
          technician: document.getElementById("technician").value,
          notes: document.getElementById("notes").value,
        };

        records.push(record);
        localStorage.setItem("maintenanceRecords", JSON.stringify(records));

        renderTable();
        form.reset();
      });

      // Download JSON file
      downloadBtn.addEventListener("click", function () {
        const blob = new Blob([JSON.stringify(records, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "maintenance_records.json";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      });

      // Download CSV file
      downloadCsvBtn.addEventListener("click", function () {
        if (records.length === 0) return;

        const headers = Object.keys(records[0]).join(",");
        const rows = records.map((record) => {
          return Object.values(record)
            .map((value) => `"${value}"`)
            .join(",");
        });
        const csvContent = [headers, ...rows].join("\n");

        const blob = new Blob([csvContent], { type: "text/csv" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "maintenance_records.csv";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      });
    </script>
  </body>
</html>
